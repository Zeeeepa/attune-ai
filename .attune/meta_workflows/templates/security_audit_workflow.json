{
  "template_id": "security_audit_workflow",
  "name": "Security Audit Workflow",
  "description": "Comprehensive security audit with vulnerability scanning, dependency checking, and compliance validation",
  "version": "1.0.0",
  "author": "Attune AI Team",
  "created_at": "2026-01-17T09:00:00Z",
  "estimated_cost_range": [
    0.25,
    3.0
  ],
  "form_schema": {
    "title": "Security Audit Configuration",
    "description": "Configure your comprehensive security audit with compliance validation",
    "questions": [
      {
        "id": "audit_scope",
        "type": "single_select",
        "options": [
          "Single module/package",
          "Entire application",
          "API endpoints only",
          "Full stack (frontend + backend)"
        ],
        "required": true,
        "text": "What is the scope of your security audit?",
        "default": null
      },
      {
        "id": "compliance_standards",
        "type": "multi_select",
        "options": [
          "OWASP Top 10",
          "CWE Top 25",
          "PCI DSS",
          "HIPAA",
          "SOC 2",
          "GDPR",
          "None - general security only"
        ],
        "required": true,
        "help_text": "Select all applicable compliance frameworks",
        "text": "Which compliance standards must be validated?",
        "default": null
      },
      {
        "id": "severity_threshold",
        "type": "single_select",
        "options": [
          "Critical only",
          "High and above",
          "Medium and above",
          "All findings (including Low)"
        ],
        "required": true,
        "help_text": "Lower thresholds generate more comprehensive reports",
        "text": "What is the minimum severity level to report?",
        "default": null
      },
      {
        "id": "scan_dependencies",
        "type": "boolean",
        "required": true,
        "help_text": "Checks pip/npm packages against CVE databases",
        "text": "Scan dependencies for known vulnerabilities?",
        "options": [],
        "default": null
      },
      {
        "id": "dependency_update_strategy",
        "type": "single_select",
        "options": [
          "Report only (no changes)",
          "Suggest updates (show available versions)",
          "Auto-update to latest patch versions",
          "Auto-update to latest minor versions"
        ],
        "required": false,
        "dependencies": {
          "scan_dependencies": true
        },
        "text": "How should vulnerable dependencies be handled?",
        "default": null
      },
      {
        "id": "code_scan_type",
        "type": "multi_select",
        "options": [
          "Static analysis (Bandit, Semgrep)",
          "Secret detection (detect-secrets, truffleHog)",
          "SQL injection patterns",
          "XSS vulnerability patterns",
          "Path traversal checks",
          "Authentication/authorization issues"
        ],
        "required": true,
        "text": "What type of code scanning should be performed?",
        "default": null
      },
      {
        "id": "include_config_audit",
        "type": "boolean",
        "required": true,
        "help_text": "Checks .env, config.yaml, docker-compose.yml, etc.",
        "text": "Audit configuration files for security issues?",
        "options": [],
        "default": null
      },
      {
        "id": "generate_report_format",
        "type": "multi_select",
        "options": [
          "Markdown summary",
          "JSON (machine-readable)",
          "HTML (detailed with charts)",
          "SARIF (for GitHub Security)",
          "PDF (executive summary)"
        ],
        "required": true,
        "text": "What format should the security report use?",
        "default": null
      },
      {
        "id": "auto_create_issues",
        "type": "boolean",
        "required": false,
        "help_text": "Creates issues tagged with severity levels",
        "text": "Automatically create GitHub issues for findings?",
        "options": [],
        "default": null
      }
    ]
  },
  "agent_composition_rules": [
    {
      "role": "vulnerability_scanner",
      "base_template": "security_specialist",
      "tier_strategy": "capable_first",
      "required_responses": {},
      "config": {
        "scope": "{{audit_scope}}",
        "scan_types": "{{code_scan_type}}",
        "severity_threshold": "{{severity_threshold}}"
      },
      "tools": [
        "bandit",
        "semgrep",
        "safety"
      ],
      "success_criteria": {
        "scan_complete": true,
        "findings_categorized": true
      }
    },
    {
      "role": "dependency_checker",
      "base_template": "security_specialist",
      "tier_strategy": "cheap_only",
      "required_responses": {
        "scan_dependencies": true
      },
      "config": {
        "check_cves": true,
        "update_strategy": "{{dependency_update_strategy}}",
        "check_licenses": true
      },
      "tools": [
        "pip-audit",
        "safety",
        "npm-audit"
      ],
      "success_criteria": {
        "dependencies_scanned": true,
        "vulnerabilities_identified": true
      }
    },
    {
      "role": "secret_detector",
      "base_template": "security_specialist",
      "tier_strategy": "cheap_only",
      "required_responses": {},
      "config": {
        "scan_git_history": true,
        "check_config_files": "{{include_config_audit}}",
        "entropy_analysis": true
      },
      "tools": [
        "detect-secrets",
        "truffleHog",
        "git-secrets"
      ],
      "success_criteria": {
        "secrets_scanned": true,
        "no_exposed_secrets": true
      }
    },
    {
      "role": "owasp_validator",
      "base_template": "security_specialist",
      "tier_strategy": "progressive",
      "required_responses": {},
      "config": {
        "compliance_standards": "{{compliance_standards}}",
        "check_owasp_top10": true,
        "check_cwe_top25": true
      },
      "tools": [
        "custom_validators",
        "owasp_zap"
      ],
      "success_criteria": {
        "owasp_validated": true,
        "compliance_checked": true
      }
    },
    {
      "role": "config_auditor",
      "base_template": "security_specialist",
      "tier_strategy": "cheap_only",
      "required_responses": {
        "include_config_audit": true
      },
      "config": {
        "check_secrets_in_config": true,
        "check_permissions": true,
        "check_defaults": true
      },
      "tools": [
        "yaml_validator",
        "env_checker"
      ],
      "success_criteria": {
        "configs_audited": true,
        "no_hardcoded_secrets": true
      }
    },
    {
      "role": "compliance_validator",
      "base_template": "security_specialist",
      "tier_strategy": "capable_first",
      "required_responses": {},
      "config": {
        "standards": "{{compliance_standards}}",
        "generate_evidence": true,
        "check_data_handling": true
      },
      "tools": [
        "compliance_checkers"
      ],
      "success_criteria": {
        "compliance_validated": true,
        "evidence_collected": true
      }
    },
    {
      "role": "report_generator",
      "base_template": "documentation_writer",
      "tier_strategy": "progressive",
      "required_responses": {},
      "config": {
        "report_formats": "{{generate_report_format}}",
        "include_remediation": true,
        "severity_breakdown": true
      },
      "tools": [
        "report_templates",
        "chart_generator"
      ],
      "success_criteria": {
        "report_generated": true,
        "actionable_recommendations": true
      }
    },
    {
      "role": "issue_creator",
      "base_template": "automation_specialist",
      "tier_strategy": "cheap_only",
      "required_responses": {
        "auto_create_issues": true
      },
      "config": {
        "platform": "github",
        "tag_by_severity": true,
        "assign_to_team": false
      },
      "tools": [
        "gh_cli",
        "api_client"
      ],
      "success_criteria": {
        "issues_created": true,
        "properly_tagged": true
      }
    }
  ]
}
